<Page
    x:Class="CryptoTracker.Portfolio"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
    xmlns:controls="using:Microsoft.Toolkit.Uwp.UI.Controls"
    xmlns:telerik="using:Telerik.UI.Xaml.Controls.Chart"
    NavigationCacheMode="Enabled"
    mc:Ignorable="d">

    <Page.Resources>
        <Style x:Key="dataGrid_HeaderStyle" TargetType="ContentControl">
            <Setter Property="FontWeight" Value="SemiLight" />
            <Setter Property="FontSize" Value="14"/>
            <Setter Property="HorizontalAlignment" Value="Stretch"/>
            <Setter Property="HorizontalContentAlignment" Value="Stretch"/>
            <Setter Property="Foreground" Value="White"/>
            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate TargetType="ContentControl">
                        <ContentPresenter Content="{TemplateBinding Content}"
                            ContentTemplate="{TemplateBinding ContentTemplate}"
                            Margin="1, 0" 
                            Background="#3F3F3F" 
                            ContentTransitions="{TemplateBinding ContentTransitions}"
                            HorizontalContentAlignment="Center"
                            VerticalContentAlignment="Center"/>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
        </Style>
    </Page.Resources>

    <Grid x:Name="MainGrid">

        <Grid.RowDefinitions>
            <RowDefinition Height="auto"/>
            <RowDefinition Height="auto"/>
            <RowDefinition Height="auto"/>
            <RowDefinition Height="*"/>
            <RowDefinition Height="*"/>
        </Grid.RowDefinitions>


        <RelativePanel Grid.Row="0" Grid.ColumnSpan="2" Padding="0, 0, 0, -10"
                       BorderThickness="0, 0, 0, 0.5" 
                       BorderBrush="{ThemeResource SystemControlForegroundChromeHighBrush}"
                       Visibility="Collapsed">
            <TextBlock Name="Portfolio_total" 
                       Text="0€"
                       FontSize="24"
                       FontWeight="Light"/>

        </RelativePanel>

        <!-- 
        ############################################################################################################### -->
        <StackPanel Grid.Row="1" Orientation="Horizontal" Margin="15">
            <ComboBox x:Name="CryptoComboBox" PlaceholderText="Coin" Header="Crypto"/>

            <TextBox 
                x:Name="cryptoQtyTextBox" Header="Amount"
                Margin="5, 0" PlaceholderText="0.2718" Width="70"/>
            <TextBox 
                x:Name="investedQtyTextBox" Header="Invested"
                Margin="5, 0" PlaceholderText="27" Width="70"/>
            
            <Button Click="AddButton_Click" VerticalAlignment="Bottom" 
                Margin="5, 0" 
                Background="#3F3F3F" 
                Foreground="White">
                <SymbolIcon Symbol="Add"/>
            </Button>
            <Button Click="RemovePortfolio_Click" VerticalAlignment="Bottom" 
                Background="#3F3F3F" 
                Foreground="White">
                <SymbolIcon Symbol="Delete"/>
            </Button>
        </StackPanel>

        <!-- 
        ############################################################################################################### -->
        <Grid Grid.Row="2" Margin="15, 0">
            <Grid.ColumnDefinitions>
                <ColumnDefinition Width="1.2*"/>
                <ColumnDefinition Width="*"/>
                <ColumnDefinition Width="1.2*"/>
                <ColumnDefinition Width="1.5*"/>
                <ColumnDefinition Width="*"/>
            </Grid.ColumnDefinitions>

            <Border Grid.Column="0" BorderThickness="0" Background="#3F3F3F">
                <TextBlock Text="Crypto" Style="{StaticResource ListViewTextBlockTitle}"/>
            </Border>

            <Border Grid.Column="1" BorderThickness="2, 0, 2, 0" Background="#3F3F3F"
                BorderBrush="{ThemeResource SystemControlPageBackgroundChromeLowBrush}">
                <TextBlock Text="Invested" Style="{StaticResource ListViewTextBlockTitle}"/>
            </Border>

            <Border Grid.Column="2" BorderThickness="0, 0, 2, 0" Background="#3F3F3F" 
                BorderBrush="{ThemeResource SystemControlPageBackgroundChromeLowBrush}">
                <TextBlock Text="Bought at" Style="{StaticResource ListViewTextBlockTitle}"/>
            </Border>

            <Border Grid.Column="3" BorderThickness="0, 0, 2, 0" Background="#3F3F3F">
                <TextBlock Text="Currently" Style="{StaticResource ListViewTextBlockTitle}"/>
            </Border>

            <Border Grid.Column="4" BorderThickness="0" Background="#3F3F3F">
                <TextBlock Text="Profit" Style="{StaticResource ListViewTextBlockTitle}"/>
            </Border>
        </Grid>

        <!-- 
        ###############################################################################################################
        ###############################################################################################################
        ############################################################################################################### -->
        <ScrollViewer Grid.Row="3" Margin="15, 0">
            <ListView x:Name="portfolioListView" 
                      Background="Transparent" 
                      ItemClick="portfolioListView_ItemClick"
                      IsItemClickEnabled="True"
                      SelectionMode="Single">

                <ListView.ItemTemplate>
                    <DataTemplate>
                        <Grid Background="{ThemeResource SystemControlBackgroundChromeMediumBrush}" 
                              Margin="-10, -20"
                              BorderBrush="#3F3F3F" BorderThickness="0, 0, 0, 1">
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="1.2*"/>
                                <ColumnDefinition Width="*"/>
                                <ColumnDefinition Width="1.2*"/>
                                <ColumnDefinition Width="1.5*"/>
                                <ColumnDefinition Width="*"/>
                            </Grid.ColumnDefinitions>

                            <TextBlock 
                                Grid.Column="0" 
                                HorizontalAlignment="Center" 
                                Style="{StaticResource ListViewTextBlock}"
                                FontWeight="Medium">
                                <Run Text="{Binding CryptoQty}"/>
                                <Run Text="{Binding Crypto}"/>
                            </TextBlock>

                            <TextBlock 
                                Grid.Column="1" 
                                HorizontalAlignment="Center" 
                                Style="{StaticResource ListViewTextBlock}">
                                <Run Text="{Binding InvestedQty}"/>
                                <Run Text="{Binding c, Mode=OneWay}"/>
                            </TextBlock>

                            <TextBlock 
                                Grid.Column="2" 
                                HorizontalAlignment="Center" 
                                Style="{StaticResource ListViewTextBlock}">
                                <Run Text="{Binding BoughtAt}"/>
                                <Run Text="{Binding c, Mode=OneWay}"/>
                            </TextBlock>

                            <TextBlock 
                                Grid.Column="3" 
                                HorizontalAlignment="Center" 
                                Foreground="{Binding ProfitFG, Mode=TwoWay}"
                                Style="{StaticResource ListViewTextBlock}">
                                <Run Text="{Binding arrow, Mode=OneWay}"/>
                                <Run Text="{Binding Current, Mode=OneWay}"/>
                                <Run Text="{Binding c, Mode=OneWay}"/>
                            </TextBlock>

                            <TextBlock 
                                Grid.Column="4" 
                                HorizontalAlignment="Center" 
                                Style="{StaticResource ListViewTextBlock}">
                                <Run Text="{Binding Profit, Mode=OneWay}"/>
                                <Run Text="{Binding c, Mode=OneWay}"/>
                            </TextBlock>

                        </Grid>
                    </DataTemplate>
                </ListView.ItemTemplate>

                <ListView.ItemContainerStyle>
                    <Style TargetType="ListViewItem">
                        <Setter Property="HorizontalContentAlignment" Value="Stretch" />

                    </Style>
                </ListView.ItemContainerStyle>
            </ListView>
        </ScrollViewer>

        <!-- 
        ###############################################################################################################
        ###############################################################################################################
        ############################################################################################################### -->
        <telerik:RadPieChart Grid.Row="4" x:Name="portfolioPieChart" PaletteName="DefaultDark" Visibility="Collapsed">
            <telerik:PieSeries ShowLabels="True">
                <telerik:PieSeries.ValueBinding>
                    <telerik:PropertyNameDataPointBinding PropertyName="Value"/>
                </telerik:PieSeries.ValueBinding>
            </telerik:PieSeries>
        </telerik:RadPieChart>


        <controls:DataGrid x:Name="dataGridd" Grid.Row="4" Margin="12" Visibility="Visible" ColumnHeaderStyle="{ThemeResource dataGrid_HeaderStyle}"
            VerticalAlignment="Top" HorizontalAlignment="Stretch"
            HorizontalContentAlignment="Stretch"
            HorizontalScrollBarVisibility="Visible" VerticalScrollBarVisibility="Visible"
            AlternatingRowBackground="Transparent" AlternatingRowForeground="Gray"
            AreRowDetailsFrozen="True" AreRowGroupHeadersFrozen="True"
            AutoGenerateColumns="False"
            CanUserSortColumns="False" CanUserReorderColumns="False" CanUserResizeColumns="False"
            GridLinesVisibility="Horizontal" 
            ColumnHeaderHeight="32" MaxColumnWidth="400"
            HeadersVisibility="Column"
            IsReadOnly="True"
            RowDetailsVisibilityMode="VisibleWhenSelected"
            SelectionMode="Single">
            <controls:DataGrid.Columns>
                <controls:DataGridTextColumn Header="Crypto"    Binding="{Binding CryptoQty}"   Width="100"/>
                <controls:DataGridTextColumn Header="Invested"  Binding="{Binding InvestedQty}" Width="100"/>
                <controls:DataGridTextColumn Header="Bought at" Binding="{Binding BoughtAt}"    Width="100"/>
                <controls:DataGridTextColumn Header="Currently" Binding="{Binding Current}"     Width="100"/>
                <controls:DataGridTextColumn Header="Profit"    Binding="{Binding Profit}"      Width="100"/>
                <controls:DataGridTextColumn Header="test"      Binding="{Binding Crypto}"      Width="100"/>
            </controls:DataGrid.Columns>

            <controls:DataGrid.RowDetailsTemplate>
                <DataTemplate>
                    <StackPanel Orientation="Horizontal"  Background="LightBlue">

                        <TextBlock Margin="10,0" Style="{StaticResource ListViewTextBlock}" FontWeight="Medium">
                            <Run Text="{Binding CryptoQty}"/>
                            <Run Text="{Binding Crypto}"/>
                        </TextBlock>
                        <TextBlock Margin="10,0" Style="{StaticResource ListViewTextBlock}" Foreground="{Binding ProfitFG, Mode=OneWay}" FontWeight="Medium">
                            <Run Text="Difference" Foreground="Black"/>
                            <Run Text="{Binding arrow, Mode=OneWay}"/>
                            <Run Text="{Binding Current, Mode=OneWay}"/>
                            <Run Text="{Binding c, Mode=OneWay}"/>
                        </TextBlock>
                    </StackPanel>
                </DataTemplate>
            </controls:DataGrid.RowDetailsTemplate>

        </controls:DataGrid>

        <!-- 
        ###############################################################################################################
        ###############################################################################################################
        ############################################################################################################### -->
        
        
    </Grid>

</Page>
